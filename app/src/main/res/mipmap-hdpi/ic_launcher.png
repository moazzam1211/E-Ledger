package com.example.invoices;

import androidx.annotation.RequiresApi;
import androidx.appcompat.app.AppCompatActivity;
import androidx.core.app.ActivityCompat;

import android.Manifest;
import android.content.pm.PackageManager;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.pdf.PdfDocument;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

public class MainActivity extends AppCompatActivity {

    Button generateInvoice;
    Spinner item1, item2;
    EditText customerName,  customerPhone, customerEmail, qty1, qty2;
    Bitmap bitmap, scaledbmp;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        generateInvoice= findViewById(R.id.invoice);
        item1 = findViewById(R.id.drinks);
        item2 =findViewById(R.id.food);
        customerName = findViewById(R.id.Cust_name);
        customerPhone = findViewById(R.id.Cust_phone);
        customerEmail = findViewById(R.id.Cust_email);
        qty1 = findViewById(R.id.qty);
        qty2 = findViewById(R.id.qty1);
        bitmap = BitmapFactory.decodeResource(getResources(),R.drawable.invoice);
        scaledbmp =  Bitmap.createScaledBitmap(bitmap,1280,553,false);
      ActivityCompat.requestPermissions(this, new String[]{
              Manifest.permission.WRITE_EXTERNAL_STORAGE}, PackageManager.PERMISSION_GRANTED);
      creatPDF();
      }

    private void creatPDF() {
        generateInvoice.setOnClickListener(new View.OnClickListener() {
            @RequiresApi(api = Build.VERSION_CODES.KITKAT)
            @Override
            public void onClick(View v) {
                if (customerName.getText().toString().length()==0
                        ||customerPhone.getText().toString().length()==0
                        ||customerEmail.getText().toString().length()==0
                        || qty1.getText().toString().length()==0
                        ||qty2.getText().toString().length()==0)
                {
                    Toast.makeText(MainActivity.this, "Some Fields Empty!", Toast.LENGTH_LONG).show();
                }
                else{


                PdfDocument pdfDocument = new PdfDocument();
                Paint paint = new Paint();
                Paint paint1 = new Paint();
                PdfDocument.PageInfo pageInfo = new PdfDocument.PageInfo.Builder(1200,2010,1).create();
                PdfDocument.Page page = pdfDocument.startPage(pageInfo);
                Canvas canvas = page.getCanvas();
                canvas.drawBitmap(scaledbmp,0,0,paint);
                paint1.setTextAlign(Paint.Align);
                pdfDocument.finishPage(page);
                File file =  new File(Environment.getExternalStorageDirectory(),"/Invoice.pdf");
                try {
                    pdfDocument.writeTo(new FileOutputStream(file));
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                } pdfDocument.close();
     